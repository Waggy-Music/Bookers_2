<% if @book.errors.any? %>
  <p><%=@book.errors.count %> errors prohibited this book from being saved:</p>
    <ul><% @book.errors.full_messages.each do |message| %>
     <li><%= message %></li>
    <%end%> 
    </ul>
 <%end%> 
<div class="container px-5 px-sm-0">
  <div class="row">
    <div class="col-md-3">
      <h2>User info</h2>
      <%= image_tag @user.get_profile_image(100,100) %>
        <table class="table">
          <tr>
            <th>name</th>
            <th><%= @user.name %></th>
          </tr>
          <tr>
            <th>introduction</th><th><%=@user.introduction %></th>
          </tr>
          <tr>
            <th>follows</th><th><%= link_to @user.followings.count,user_followings_path(@user) %></th>
          </tr>
          <tr>
            <th>followers</th><th><%=link_to @user.followers.count,user_followers_path(@user) %></th>
          </tr>
        </table>
      
        <%=link_to edit_user_path,class: "btn btn-outline-secondary btn-block" do %>
        <i class="fas fa-user-cog"></i>
         <%end%>
        <% if current_user != @user%> 
         <%= render "relationships/btn",user: @user   %>   
        <% end %>
      <h2 class="mt-3">New book</h2>
      <%=form_with model: @book,method: :post do |f|%>
        <p>Title</p>
        <%=f.text_field:title%>
        
        <p>Opinion</p>
        <%=f.text_area:body%>
        <!--<script src="raty.js"></script>-->
        <!--<div data-raty></div>-->
        <p>Rate<div id="score"></div></p>
        
        
        <%=f.submit'Create Book',class: "btn btn-success"%>
      <%end%>
    </div>
    
    <div class= "col-md-8 offset-md-1">
      <h2>Books</h2>
      <table class="table">
        <tr>
          <th></th>
          <th>Title</th>
          <th>Opinion</th>
          <th></th>
          <th></th>
        </tr>
        <%@books.each do |book| %>
          <tr>
            <td>
              <!--% if @user==current_user%-->
              <%=link_to user_path do %>
              <%= image_tag @user.get_profile_image(100,100) %>
              <%end%>
            </td>
            <td>
              <%=link_to book.title, book_path(book.id)%>
            </td>
            <td>
              <%=book.body%>
            </td>
            
            <td><%= link_to "#{book.book_comments.count} コメント", book_path(book.id) %></td>
            <td>
            
            </td>
            <!--%end%-->
          </tr>
        <% end %>
      </table>
    </div>
    
  </div>
</div>

<script>
  // scriptファイルをどのidの部分に配置するかを指定
  let elem = document.querySelector('#score');
  let opt = {  
    //星画像の指定などのオプションをここに記述,
    starOn: "<%= asset_path('star-on.png') %>",
    starOff: "<%= asset_path('star-off.png') %>",
    starHalf: "<%= asset_path('star-half.png') %>",
    scoreName: "book[score]",
   };
  raty(elem,opt);
</script>