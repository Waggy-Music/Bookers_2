<div class="container px-5 px-sm-0">
  <div class="row">
    <div class="col-md-3", style="position: static;">
      <%=render'users/userinfo',user: @user,book: @book%>
    </div>


<div class="col-md-8 offset-md-1">
 <h2>Books</h2>
 <%= form_with books_path, method: :get do |f| %>
  <% if @sorted.present? %>
    <%= f.select :sort, @sort_list, selected: @sorted, onChange: "javascript: this.form.submit();" %>
  <% else %>
    <%= f.select :sort, @sort_list, {}, onChange: "javascript: this.form.submit();" %>
  <% end %>
<% end %>
 <table class="table">
  <tr>
   <th></th>
   <th>Title</th>
   <th>Opinion</th><th></th>
  </tr>
  <tr>
    <%@books.each do |book| %>
    <td><%=link_to user_path(book.user) do %>
              <%= image_tag book.user.get_profile_image(100,100) %>
              <%end%>
    </td>
    <td><%=link_to book.title,book_path(book.id)%></td>
    <td><%=book.body%></td>
    <td>
     <div id="score_<%= book.id %>"></div>
    </td>
    <td id="favorite_buttons_<%= book.id %>">
     <%=render "favorites/like" ,user: @user,book: book%>
    </td>
    <td><%= link_to "#{book.book_comments.count} コメント", book_path(book.id) %></td>
     
     </tr>
    <script>
      // scriptファイルをどのidの部分に配置するかを指定
      raty(
       document.querySelector('#score_<%= book.id %>'),
       {  
        //星画像の指定などのオプションをここに記述,
        starOn: "<%= asset_path('star-on.png') %>",
        starOff: "<%= asset_path('star-off.png') %>",
        starHalf: "<%= asset_path('star-half.png') %>",
        scoreName: "book[score]",
        score: <%= book.score %>,
        readOnly: true,
       }
       );
    </script>
   <%end%>
    
</table>
</div>

